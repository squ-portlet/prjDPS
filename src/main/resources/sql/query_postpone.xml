<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
    <comment>DPS Postponement Queries</comment>
    <entry key="dps.postpone.select.postpone.reasons">
    	SELECT 
			CODE.SISCODECD										AS		SISCODECD	
			,DECODE 
					(
					  :paramLocale,
					  'en', CODE.CODENM, CODE.A_CODENM
					)     										AS		POSTPONE_REASON_NAME
		FROM 
		    SIS_CODES CODE,
        	SIS_CODE_TYPES CODE_TYPE
		WHERE
        		CODE.SISCODETYPCD = CODE_TYPE.SISCODETYPCD
		    AND CODE_TYPE.SISCODETYPNM = 'PST_REASON'
    </entry>
    <entry key="dps.postpone.select.student.records">
		SELECT 
		          TO_CHAR(POSTPN.CREATE_DATE,'DD/MM/YYYY')									AS		CREATE_DATE
		        , POSTPN.TOCCYRCD															AS		TOCCYRCD
		        , POSTPN.TOSEMCD															AS		SEMCD
		        , (
		            SELECT 
		                DECODE 
		                (
		                  :paramLocale,
		                  'en', SEMNM, A_SEMNM
		                )
		              FROM SEM
		              WHERE SEMCD = POSTPN.TOSEMCD
		          ) 																		AS 		SEM_NAME
		        , POSTPN.PSTREASONCD  														AS		POSTPONE_REASON_CODE
		        , DECODE
		          (
		            SISCD.L_ABR_CODE
		            ,'OTHR',POSTPN.OTHER_REASON, 
		              DECODE
		              (
		                  :paramLocale
		                  ,'en', SISCD.CODENM, SISCD.A_CODENM
		              )
		            )                                           							AS 		POSTPONE_REASON_NAME
		        , POSTPN.OTHER_REASON														AS		POSTPONE_OTHER_REASON							    
		        , POSTPN.POSTREQ_STATUSCD													AS		STATUS_CODE
		        , (
		        	SELECT
		        		L_ABR_CODE
		        	FROM SIS_CODES
		            WHERE 
		            	SISCODECD= POSTPN.POSTREQ_STATUSCD
		        	)																		AS		STATUS_CODE_NAME
		        , (
		            SELECT 
		              DECODE 
		              (
		                :paramLocale
		                ,'en', CODENM, A_CODENM
		                )
		              FROM SIS_CODES
		              WHERE SISCODECD= POSTPN.POSTREQ_STATUSCD
		            ) 																		AS 		STATUS_DESC
		       , POSTPN.COMMNT																AS		COMMENTS
		          , FUNC_APPROVE_STATUS(
	                            POSTPN.STDNO,
	                            :paramAdvisorRoleName, 
	                            :paramFormName
	                            )                           								AS  	ADVISOR_STATUS            																		
	          , FUNC_APPROVE_STATUS(
	                            POSTPN.STDNO,
	                            :paramSupervisorRoleName, 
	                            :paramFormName
	                            )                           								AS  	SUPERVISOR_STATUS
	        , FUNC_APPROVE_STATUS(
	                            POSTPN.STDNO,
	                            :paramColDeanRoleName, 
	                            :paramFormName
	                            )                           								AS  	COLLEGE_DEAN_STATUS
	        , FUNC_APPROVE_STATUS(
	                            POSTPN.STDNO,
	                            :paramDpsDeanRoleName, 
	                            :paramFormName
	                            )                           								AS  	DPS_DEAN_STATUS	 
			, FUNC_GET_APPROVALCODE(
								:paramFormName,
								:paramAdvisorRoleName
								)	                                                        AS  	ADVISOR_APPROVAL_CODE
			, FUNC_GET_APPROVALCODE(
								:paramFormName,
								:paramSupervisorRoleName
								)															AS		SUPERVISOR_APPROVAL_CODE
			, FUNC_GET_APPROVALCODE(
								:paramFormName,
								:paramColDeanRoleName
								)															AS		COLLEGE_DEAN_APPROVAL_CODE
			, FUNC_GET_APPROVALCODE(
								:paramFormName,
								:paramDpsDeanRoleName
								)															AS		DPS_DEAN_APPROVAL_CODE														               
		FROM 
		    STD_POSTPONE POSTPN,
		    SIS_CODES     SISCD
		
		WHERE
		        POSTPN.PSTREASONCD=SISCD.SISCODECD
		    AND STDNO = :paramStdNo    
    </entry>
    <entry key="dps.postpone.insert.student">
		INSERT INTO STD_POSTPONE
		(
			  STDNO 
			, STDSTATCD 
			, FROMCCYRCD 
			, FROMSEMCD 
			, TOCCYRCD 
			, TOSEMCD 
			, PSTREASONCD 
			, OTHER_REASON 
			, POSTREQ_STATUSCD 
			, CREATE_DATE 
			, CREATE_USERNAME 
		)
		VALUES 
		(
			  :paramStdNo
			, :paramStdStatCode
			, :paramFromYearCode
			, :paramFromSemCode
			, :paramToYearCode
			, :paramToSemCode
			, :paramPostponeReasonCode
			, :paramPostponeReasonOther
			, (
				SELECT
					CODES.SISCODECD	
				FROM
						SIS_CODES       CODES
					,   SIS_CODE_TYPES  TYPES
				WHERE
						CODES.SISCODETYPCD =  TYPES.SISCODETYPCD
					AND TYPES.SISCODETYPNM = 'APPROVAL_STATUS'
					AND CODES.L_ABR_CODE  = :paramPostponeStatusCode
			   )
			, SYSDATE
			, :paramUserCode 
		)    
    </entry>
</properties>