<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<comment>DPS Grades Queries</comment>
	<entry key="dps.grades.select.student.grades">
				SELECT
                  DISTINCT
			            	GRADES.L_ABR_CRSNO                                          AS    L_ABR_CRSNO
			         	,  	DECODE (
			                     :paramLocale
			                     , 'ar', A_CRSSNM
			                     , CRS.CRSSNM
			                    )                                                 		AS      COURSE_NAME 
               			,  GRADES.SECTNO                                             	AS      SECTION_NO
			         	,  GRADES.GRADECD                                            	AS      GRADE_CODE
			         	,  DECODE
			                  (
			                    :paramLocale
			                    , 'ar', GV.A_ABR_GVAL
			                    ,      GV.L_ABR_GVAL
			                  )                                                   		AS      GRADE_VAL
                , (
                    SELECT 
                          COUNT(SCHEDW.FACSURNMCD)
                    FROM 
                            SCHED_WEEKLY        SCHEDW
                          , SECT_DAGR           SECTDGR
                    WHERE
                              SCHEDW.SECTCD= SECTDGR.SECTCD 
                          AND SCHEDW.FACSURNMCD = :paramEmpNo
                          AND SECTDGR.CCYRCD = :paramYear
                          AND SECTDGR.SEMCD = :paramSem
                          AND SECTDGR.L_ABR_CRSNO = GRADES.L_ABR_CRSNO
                )                                                               		AS EMP_COUNT
                  
			            
			FROM
			           GRADE_VAL           GV
			        ,  STD_GRADES          GRADES
			        ,  CRS_BASIC           CRS

           		,  V_STDINFO_PORTAL    VSP
			         
			WHERE
			
                	VSP.STD_ID = :paramStdId
			    AND GRADES.CCYRCD=:paramYear
			    AND GRADES.SEMCD=:paramSem
            	AND GRADES.STDNO = VSP.STDNO
            	AND VSP.ACTIVE  = 'Y'
			    AND GV.GRADECD  = GRADES.GRADECD
			    AND CRS.CRSNO = GRADES.CRSNO	

            	AND (
                		GRADES.L_ABR_CRSNO  = :paramLAbrCrsNo
                		OR :paramLAbrCrsNo IS NULL
               		)
	</entry>
	<entry key="dps.grades.select.grade.values">
		SELECT
		          GV.GRADECD                          AS  GRADE_CODE
		       ,  DECODE
		                (
		                  :paramLocale
		                  , 'ar', GV.A_ABR_GVAL
		                  , GV.L_ABR_GVAL
		                )                             AS  GRADE_VAL
		FROM  
		      GRADE_VAL GV
		
		ORDER BY GRADE_VAL	
	</entry>
	<entry key="dps.grades.select.grade.change.history">
		SELECT 
		          TGRADE.L_ABR_CRSNO					AS    	L_ABR_CRSNO
		      ,   TGRADE.SECTNO							AS		SECTION_NO
		      ,   (
		              SELECT
		                    DECODE
		                    (
		                        'ar', A_ABR_GVAL
		                      , L_ABR_GVAL
		                    )
		              FROM
		                    GRADE_VAL
		              WHERE
		                    GRADECD = GRADECD_OLD
		          )										AS		GRADE_VAL_NEW
		      ,   (
		              SELECT
		                    DECODE
		                    (
		                        'ar', A_ABR_GVAL
		                      , L_ABR_GVAL
		                    )
		              FROM
		                    GRADE_VAL
		              WHERE
		                    GRADECD = GRADECD_NEW
		          )										AS		GRADE_VAL_OLD
		FROM
		      	T_STD_GRADES  		TGRADE
		      ,  V_STDINFO_PORTAL    VSP
		WHERE
		          VSP.STD_ID 	= :paramStdId
		      AND TGRADE.CCYRCD = :paramYear
		      AND TGRADE.STDNO 	= VSP.STDNO	
		ORDER BY TGRADE.UPDATE_DATE DESC
	</entry>
	<entry key="dps.grades.update.grade">
		UPDATE
		      STD_GRADES
		      SET GRADECD = :paramGradeCode
		WHERE
		           STDNO = :paramStdNo
		      AND CCYRCD=:paramYear
		      AND SEMCD=:paramSem
		      AND L_ABR_CRSNO = :paramCourseLAbrCode	
	
	</entry>

</properties>